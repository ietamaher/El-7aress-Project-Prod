{
  "version": "2.0",
  "comment": "OPTIMIZED Motion Tuning - 50ms update cycle, AZD-KD servo",

  "filters": {
    "gyro": {
      "cutoffFreqHz": 8.0,
      "comment": "Slightly higher for faster response (was 5.0)"
    },
    "tracking": {
      "positionTau": 0.04,
      "velocityTau": 0.03,
      "comment": "REDUCED from 0.12/0.08 - faster target following"
    },
    "manual": {
      "joystickTau": 0.05,
      "comment": "Responsive joystick (was 0.08)"
    }
  },

  "motion": {
    "maxAccelerationDegS2": 400.0,
    "scanMaxAccelDegS2": 100.0,
    "trpMaxAccelDegS2": 200.0,
    "trpDefaultTravelSpeed": 20.0,
    "maxVelocityDegS": 60.0,
    "arrivalThresholdDeg": 0.3,
    "updateIntervalS": 0.05,
    "comment": "INCREASED maxAccel from 50 to 400 - must be <= hardware limit (880 deg/s²)"
  },

  "servo": {
    "azStepsPerDegree": 568.627350634,
    "elStepsPerDegree": 555.5556,
    "hardwareAccelHz_s": 500000,
    "comment": "500kHz/s = ~880 deg/s² for AZ, ~900 deg/s² for EL"
  },

  "pid": {
    "tracking": {
      "azimuth": {
        "kp": 2.5,
        "ki": 0.3,
        "kd": 0.08,
        "maxIntegral": 8.0,
        "comment": "ADDED Kd for damping! Was 0 causing overshoot"
      },
      "elevation": {
        "kp": 2.8,
        "ki": 0.3,
        "kd": 0.08,
        "maxIntegral": 10.0,
        "comment": "Slightly higher gains for gravity compensation"
      }
    },

    "autoSectorScan": {
      "azimuth": {
        "kp": 1.2,
        "ki": 0.05,
        "kd": 0.15,
        "maxIntegral": 15.0
      },
      "elevation": {
        "kp": 1.5,
        "ki": 0.05,
        "kd": 0.15,
        "maxIntegral": 15.0
      },
      "decelerationDistanceDeg": 3.0,
      "arrivalThresholdDeg": 0.2
    },

    "trpScan": {
      "azimuth": {
        "kp": 1.5,
        "ki": 0.08,
        "kd": 0.2,
        "maxIntegral": 20.0
      },
      "elevation": {
        "kp": 1.8,
        "ki": 0.1,
        "kd": 0.25,
        "maxIntegral": 20.0
      },
      "decelerationDistanceDeg": 2.0,
      "arrivalThresholdDeg": 0.1
    },

    "radarSlew": {
      "azimuth": {
        "kp": 2.0,
        "ki": 0.1,
        "kd": 0.2,
        "maxIntegral": 25.0
      },
      "elevation": {
        "kp": 2.0,
        "ki": 0.1,
        "kd": 0.2,
        "maxIntegral": 25.0
      }
    }
  },

  "accelLimits": {
    "manualMaxAccelHzPerSec": 500000.0,
    "comment": "Matched to hardware setting"
  },

  "axisServo": {
    "comment": "Axis-specific AZD-KX parameters for RCWS - single Modbus write optimization",
    "azimuth": {
      "accelHz": 150000,
      "decelHz": 100000,
      "currentPercent": 1000,
      "comment": "Heavy turret load - SLOW decel (100kHz/s) prevents overvoltage on sudden stops"
    },
    "elevation": {
      "accelHz": 150000,
      "decelHz": 300000,
      "currentPercent": 700,
      "comment": "Lighter gun load - FAST decel (300kHz/s) avoids overshoot, 70% current to prevent stall"
    }
  },

  "tuningNotes": {
    "critical1": "SOFTWARE ACCEL LIMIT MUST BE <= HARDWARE ACCEL LIMIT",
    "critical2": "Kd is ESSENTIAL for preventing overshoot - never set to 0",
    "critical3": "Filter tau values add phase lag - keep low for responsive tracking",
    "note1": "Hardware accel @ 500kHz/s = 880 deg/s² (AZ) - very responsive",
    "note2": "With 50ms cycle, PID needs Kd to damp oscillations",
    "note3": "Feed-forward helps tracking but PID must still damp",
    "note4": "If still oscillating: increase Kd. If too slow: increase Kp",
    "note5": "Derivative on measurement (not error) prevents kick on target jumps"
  }
}